trigger:
  - master

pr:
  - master

variables:
  BotBuilderDll: Microsoft.Bot.Builder.AI.Luis,Microsoft.Bot.Builder.AI.QnA,Microsoft.Bot.Builder.ApplicationInsights,Microsoft.Bot.Builder.Azure,Microsoft.Bot.Builder.Dialogs,Microsoft.Bot.Builder.Integration.ApplicationInsights.Core,Microsoft.Bot.Builder.Integration.AspNet.Core,Microsoft.Bot.Builder.TemplateManager,Microsoft.Bot.Builder.Testing,Microsoft.Bot.Builder,Microsoft.Bot.Configuration,Microsoft.Bot.Connector,Microsoft.Bot.Schema,Microsoft.Bot.Streaming
  BuildPlatform: any cpu
  BuildConfiguration: Debug-Windows
  OutputFile: 'result.xml'
  IsBuildServer: true # This is consumed by projects in Microsoft.Bot.Builder.sln.
  MSBuildArguments: -p:SignAssembly=false -p:delaySign=false
  Parameters.solution: Microsoft.Bot.Builder.sln
  PreviewPackageVersion: 4.8.0-preview-$(Build.BuildNumber) # This is consumed by projects in Microsoft.Bot.Builder.sln.
  ReleasePackageVersion: 4.8.0-preview-$(Build.BuildNumber) # This is consumed by projects in Microsoft.Bot.Builder.sln.

pool:
  vmImage: 'windows-2019'
  demands:
    - msbuild
    - visualstudio

stages:
- stage: Build
  jobs:
  - job: Debug_Windows_Configuration
    variables:
      BuildConfiguration: Debug-Windows
    steps:
    - template: ci-build-steps.yml
    - template: code-coverage-w-coverlet-steps.yml
    - template: code-coverage-w-coverlet-steps.yml
